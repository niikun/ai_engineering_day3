# AI_engineering_day3
Home work of AI engineering Day3
## 目的
- 演習で利用したコードをベースに、独自の質問と参照文書を用いて実験を行い、RAGの効果を定量的・定性的に評価する。
- 参照文書のどの位置に答えがあるかが、精度に大きく影響することを確認する。
- 参照文書と質問で異なった単語を使った場合の影響を確認する。

##　質問設計の観点と意図
### テーマは「大谷翔平選手」、「大阪・関西万博」を選んだ
その意図は以下の点です。
- テーマとしてWeb上に多くの情報があり、RAGがなくても一部回答できるテーマである。
- Web上で間違った情報があるテーマである。
  - 過去の間違った報道が出ている可能性があるもの
  - 万博については、過去の万博の情報も残っている
- 明確にLLMが学んでいない情報が特定できるテーマである。

### 質問については以下の点を意図した
- 質問の答えに必要な事項が、参照文書内で、距離がある場所に記載されている場合と記載をまとめた場合を比較する。
- 質問に使う言葉と参照文書で使っている言葉が違っている場合を比較する。

## RAGの実装方法と工夫点
### RAGの実装について
以下のモデルを実装し比較した。
- RAG なし
- SimpleRAG
  - 分割方法: 「。」（句点）で区切られた文単位でテキストを分割
  - 検索手法: シンプルな類似度ベースの検索でクエリに関連する文を参照文章として抽出
- Context RAG
  - 分割方法: 「。」（句点）で区切られた文単位でテキストを分割
  - 検索手法: マッチした文を中心に前2文、後2文を含む計5文程度のチャンクを参照文章として抽出
- Rerank RAG
  -  分割方法: 「。」（句点）で区切られた文単位でテキストを分割
  - 検索手法: マッチした文に対して、LLMを活用した高度な関連性評価を実施し、牽連性の高いものを参照文書として抽出
### 工夫点
- コードの整理
  - テーマ、質問に対して簡単に実験できるようにコードを整理 
- 結果の見える化
  - 結果が一目でわかるようにノートブック上で可視化
  - RAGの参照文章も都度確認できるようにした 

## 結果の分析と考察
### 実験結果
| テーマ           | 参照文章     | 質問                               | no_rag | simple_rag | contex_rag | rerank_rag |
|------------------|--------------|------------------------------------|--------|------------|------------|------------|
| 大谷翔平         | 参照文章①   | 大谷翔平の職業は何ですか？         | 2      | 2          | 2          | 2          |
| 大谷翔平         | 参照文章①   | 2024年の競技外収入は何位ですか？   | 0      | 4          | 2          | 4          |
| 大谷翔平         | 参照文章①   | 配偶者の名前と過去のスポーツ経験   | 0      | 4          | 3          | 0          |
| 大谷翔平         | 参照文章①   | 妻の名前と過去のスポーツ経験       | 0      | 2          | 4          | 0          |
| 大谷翔平         | 参照文章②   | 配偶者の名前と過去のスポーツ経験   | 0      | 2          | 2          | 2          |
| 大谷翔平         | 参照文章②   | 妻の名前と過去のスポーツ経験       | 0      | 4          | 3          | 2          |
| 大阪・関西万博   | 参照文章③   | 大阪・関西万博の会場               | 0      | 3          | 3          | 3          |
| 大阪・関西万博   | 参照文章③   | 大阪・関西万博のメインキャラクター | 0      | 0          | 4          | 0          |
| 大阪・関西万博   | 参照文章③   | 大阪・関西万博のマスコット         | 0      | 4          | 4          | 0          |　　

  
※各モデルのスコアは講座のgpt4ominiを使った評価。  

### 大谷翔平  

** 大谷翔平の職業は何ですか？**
![image](https://github.com/user-attachments/assets/a58713af-6bae-43ce-98ea-acc47594bc58)  

** 2024年の競技外収入は何位ですか？**
![image](https://github.com/user-attachments/assets/cc86aa5e-d2c7-463e-88ce-1d4046fc3b08)  

** 配偶者の名前と過去のスポーツ経験 **  
![image](https://github.com/user-attachments/assets/05754ff0-6a75-4545-b79b-6515be47f827)  


** 妻の名前と過去のスポーツ経験 **  
![image](https://github.com/user-attachments/assets/eea89631-5a24-4c4c-b6de-ccb531e6dd34)   
  
** 参照文書②配偶者の名前と過去のスポーツ経験 **  
![image](https://github.com/user-attachments/assets/4a99ba6a-d971-4dcc-84c3-480b90ee7ee9)  

** 参照文書②妻の名前と過去のスポーツ経験 **  
![image](https://github.com/user-attachments/assets/ec0a7c40-f591-425c-b3c6-9b3a30501f32)  

### 大阪・関西万博   
** 大阪・関西万博の会場 **   
![image](https://github.com/user-attachments/assets/9001335d-66b9-4292-9593-03cf1425c252)   

** 大阪・関西万博のメインキャラクター **  
![image](https://github.com/user-attachments/assets/d62b88ad-4d21-4e64-805e-01ba31c15036)　　

** 大阪・関西万博のマスコット **  
![image](https://github.com/user-attachments/assets/c15b9db6-450d-4fcc-816b-d0af3d83ac79)  


## 発展的な改善案
